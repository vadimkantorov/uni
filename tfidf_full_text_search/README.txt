Code written together with @i_komarov
